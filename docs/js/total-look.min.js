/**
 * @license tiemme-com v1.0.0
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self)["total-look"]=e()}(this,(function(){"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var n,o=function(t){function e(){return t.apply(this,arguments)||this}i(e,t);var n=e.prototype;return n.getNode=function(){if("function"==typeof this.render){var t=this.render();if(!t)return;var e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}},n.setNode=function(t){var e=this.getNode();return e&&(t.parentNode.replaceChild(e,t),t=e),this.node=t,"function"==typeof this.onInit&&this.onInit(this.node),this},n.setParentNode=function(t){var e=this.getNode();return e&&t.appendChild(e),this.node=e,"function"==typeof this.onInit&&this.onInit(this.node),this},n.destroy=function(){"function"==typeof this.onDestroy&&this.onDestroy(this.node)},e}(function(){function t(t){void 0===t&&(t={}),Object.assign(this,t),this.events={}}var e=t.prototype;return e.on=function(t,e){var i=this,n=this.events[t]=this.events[t]||[];return n.push(e),function(){i.events[t]=n.filter((function(t){return t!==e}))}},e.off=function(t,e){var i=this.events[t];i&&(this.events[t]=i.filter((function(t){return t!==e})))},e.emit=function(t,e){var i=this.events[t];i&&i.forEach((function(t){t(e)}));var n=this.events.broadcast;n&&n.forEach((function(i){i(t,e)}))},t}()),s=function(){function t(t,e,i,n){this.currentTarget=t||document,this.downCallback=e||function(t){console.log("DragListener.downCallback not setted",t)},this.moveCallback=i||function(t){console.log("DragListener.moveCallback not setted",t)},this.upCallback=n||function(t){console.log("DragListener.upCallback not setted",t)},this.dragging=!1,this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.addListeners()}e(t,[{key:"passive",get:function(){var t=this;if(void 0!==this.passive_)return this.passive_;this.passive_=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t.passive_=!0}});window.addEventListener("test",null,e)}catch(t){}return this.passive_}},{key:"options",get:function(){return!!this.passive&&{passive:!1,capture:!0}}}]);var i=t.prototype;return i.addListeners=function(){this.currentTarget.addEventListener("touchstart",this.onTouchStart,this.options),this.currentTarget.addEventListener("mousedown",this.onMouseDown,this.options)},i.destroy=function(){this.currentTarget.removeEventListener("touchstart",this.onTouchStart),this.currentTarget.removeEventListener("mousedown",this.onMouseDown),this.removeMouseListeners(),this.removeTouchListeners()},i.onDown=function(t){this.down=t,this.strength={x:0,y:0},this.distance=this.distance||{x:0,y:0},this.speed={x:0,y:0},this.downCallback(this)},i.onDrag=function(t){if(this.dragging=t&&void 0!==this.down,this.dragging){var e=this.currentTarget,i={x:t.x-this.down.x,y:t.y-this.down.y},n={x:i.x/window.innerWidth*2,y:i.y/window.innerHeight*2},o={x:this.speed.x+.1*(n.x-this.strength.x),y:this.speed.y+.1*(n.y-this.strength.y)};this.position=t,this.distance=i,this.strength=n,this.speed=o,this.moveCallback({position:t,distance:i,strength:n,speed:o,currentTarget:e})}},i.onUp=function(){this.down=void 0,this.dragging=!1,this.upCallback(this)},i.onMouseDown=function(t){this.originalEvent=t,this.target=t.target,this.currentTarget.removeEventListener("touchstart",this.onTouchStart),this.onDown({x:t.clientX,y:t.clientY}),this.addMouseListeners()},i.onMouseMove=function(t){this.originalEvent=t,this.target=t.target,this.onDrag({x:t.clientX,y:t.clientY})},i.onMouseUp=function(t){this.originalEvent=t,this.target=t.target,this.removeMouseListeners(),this.onUp()},i.onTouchStart=function(t){this.originalEvent=t,this.target=t.target,this.currentTarget.removeEventListener("mousedown",this.onMouseDown),t.touches.length>0&&(this.onDown({x:t.touches[0].pageX,y:t.touches[0].pageY}),this.addTouchListeners())},i.onTouchMove=function(t){this.originalEvent=t,this.target=t.target,t.touches.length>0&&this.onDrag({x:t.touches[0].pageX,y:t.touches[0].pageY})},i.onTouchEnd=function(t){this.originalEvent=t,this.target=t.target,this.removeTouchListeners(),this.onDrag(this.position),this.onUp()},i.addMouseListeners=function(){document.addEventListener("mousemove",this.onMouseMove,this.options),document.addEventListener("mouseup",this.onMouseUp,this.options)},i.addTouchListeners=function(){document.addEventListener("touchend",this.onTouchEnd,this.options),document.addEventListener("touchmove",this.onTouchMove,this.options)},i.removeMouseListeners=function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)},i.removeTouchListeners=function(){document.removeEventListener("touchend",this.onTouchEnd),document.removeEventListener("touchmove",this.onTouchMove)},t}(),r=function(t){function e(){return t.apply(this,arguments)||this}i(e,t);var n=e.prototype;return n.onInit=function(t){this.item=t.hasAttribute("data-item")?new Function("return "+t.getAttribute("data-item"))():{},this.addListeners()},n.onDestroy=function(){this.removeListeners()},n.onResize=function(){},n.onClick=function(){this.emit("click")},n.addListeners=function(){this.onClick=this.onClick.bind(this),this.node.addEventListener("click",this.onClick)},n.removeListeners=function(){this.node.removeEventListener("click",this.onClick)},n.update=function(){this.item.active?this.node.classList.add("active"):this.node.classList.remove("active")},e}(o),h=function(t){function e(e){var i;return(i=t.call(this)||this).item=e,i}i(e,t);var n=e.prototype;return n.onInit=function(t){this.addListeners()},n.onDestroy=function(){this.removeListeners()},n.onResize=function(){this.emit("click")},n.onClick=function(){this.emit("click")},n.addListeners=function(){this.onClick=this.onClick.bind(this),this.node.addEventListener("click",this.onClick)},n.removeListeners=function(){this.node.removeEventListener("click",this.onClick)},n.render=function(){return'<div class="pin"></div>'},n.update=function(){this.item.active?this.node.classList.add("active"):this.node.classList.remove("active")},e}(o),c=function(t){function o(){return t.apply(this,arguments)||this}i(o,t);var c=o.prototype;return c.onInit=function(t){var e=this;this.groupLook=t.querySelector(".group--look"),this.picture=t.querySelector(".group--look .picture"),this.cursor=t.querySelector(".cursor"),this.listing=t.querySelector(".listing--products"),this.listingInner=t.querySelector(".listing--products__inner"),this.cards=Array.prototype.slice.call(t.querySelectorAll(".card--product")).map((function(t){return(new r).setNode(t)})),this.pins=this.cards.map((function(t){return new h(t.item).setParentNode(e.picture)})),this.addListeners()},c.onDestroy=function(){this.removeListeners()},c.onImage=function(t){this.img=t,this.node.classList.add("init"),this.addDragListener(),this.cards.length?this.setActive(this.cards[0].item):this.onResize()},c.loadImage=function(){var t=this,e=this.node.querySelector(".group--look img"),i=new Image;i.onload=function(){t.onImage(e)},i.src=e.src},c.setActive=function(t){this.cards.forEach((function(e){e.item!==t?e.item.active=!1:e.item.active=!0,e.update()})),this.pins.forEach((function(t){return t.update()})),this.onResize()},c.onResize=function(){var t,e,i=this,n=this.img,o=this.groupLook,s=this.picture,r=o.offsetWidth,h=o.offsetHeight,c=r/h,a=n.naturalWidth/n.naturalHeight;c>a?(t=o.offsetWidth,e=o.offsetWidth/a,this.direction="vertical"):(t=o.offsetHeight*a,e=o.offsetHeight,this.direction="horizontal"),s.style.width=t+"px",s.style.height=e+"px",this.containerWidth=r,this.containerHeight=h,this.imageWidth=t,this.imageHeight=e,this.listingInner.style.width="auto",this.cards.forEach((function(t,e){var n=t.node.offsetWidth*Math.ceil(i.cards.length/2);if(0===e&&(i.listingInner.style.width=n+"px"),t.item.active){var o=r-n,s=i.listing.getBoundingClientRect().left-t.node.getBoundingClientRect().left;s=Math.min(0,Math.max(o,s)),gsap.to(i.listingInner,{x:s,duration:.3,delay:.1,overwrite:!0})}})),this.pins.forEach((function(o){var s=t/n.naturalWidth*o.item.position.x,c=t/n.naturalWidth*o.item.position.y;if(gsap.set(o.node,{x:s,y:c}),o.item.active){var a=r-t,u=h-e,d=r/2-s,l=h/2-c;gsap.to(i.picture,{x:Math.min(0,Math.max(a,d)),y:Math.min(0,Math.max(u,l)),duration:.3,overwrite:!0})}}))},c.onDelayedResize=function(){gsap.set(this.listingInner,{x:0}),n&&clearTimeout(n),n=setTimeout(this.onResize,5)},c.addListeners=function(){var t=this;this.loadImage(),this.onResize=this.onResize.bind(this),this.onDelayedResize=this.onDelayedResize.bind(this),window.addEventListener("resize",this.onDelayedResize),this.cards.forEach((function(e){e.on("click",(function(){t.setActive(e.item),t.node.classList.remove("open")}))})),this.pins.forEach((function(e){e.on("click",(function(){t.setActive(e.item),t.node.classList.add("open")}))}))},c.removeListeners=function(){this.removeDragListener(),window.removeEventListener("resize",this.onResize)},c.addDragListener=function(){var t=this,e=this.picture,i=0,n=0;this.draglistener=new s(this.groupLook,(function(o){var s=e.style.transform;if(s){var r=s.split("(")[1].split([")"])[0].split(",");i=parseFloat(r[0]),n=parseFloat(r[1])}t.node.classList.remove("open")}),(function(o){var s=t.containerWidth-t.imageWidth,r=t.containerHeight-t.imageHeight,h=i+o.distance.x,c=n+o.distance.y;gsap.to(e,{x:Math.min(0,Math.max(s,h)),y:Math.min(0,Math.max(r,c)),duration:.3,overwrite:!0})}),(function(t){}))},c.removeDragListener=function(){this.draglistener&&this.draglistener.destroy()},e(o,[{key:"direction",set:function(t){var e=this;this.direction_!==t&&(this.direction_=t,"vertical"===t?(this.node.classList.add("vertical"),this.node.classList.remove("horizontal")):(this.node.classList.add("horizontal"),this.node.classList.remove("vertical")),this.node.classList.add("show-hint"),setTimeout((function(){e.node.classList.remove("show-hint")}),4e3))}}]),o}(o),a=function(){function t(){this.addComponents()}return t.prototype.addComponents=function(){var t={"[total-look]":c},e=[],i=function(i){e=e.concat(Array.from(document.querySelectorAll(i)).map((function(e){var n=(new t[i]).setNode(e);return n.on("click",(function(){alert("clicked")})),n})))};for(var n in t)i(n);return e.forEach((function(t){return console.log(t)})),e},t}();new a;return a}));
//# sourceMappingURL=total-look.min.js.map